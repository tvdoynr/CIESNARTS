{% extends 'student_base.html' %}

{% block content %}
    <div class="row">
        <div class="col-md-6">

          <h3>Active Courses</h3>
                  <ul>
                    {% for course in page_obj %}
                      <li>
                        <label>
                          {{ course.CourseID }}  {{ course.CourseName }}  {{ course.CourseCredit}}
                          <input type="checkbox" name="selected_students" value="{{ course.pk }}">
                        </label>
                      </li>
                      <br>
                    {% empty %}
                      <li>There is no course.</li>
                    {% endfor %}
                  </ul>

                  <button type="submit" id="enroll-button" name="enroll" class="btn btn-sm btn-primary" disabled>Enroll</button>

              <script>
                const checkboxes = document.querySelectorAll('input[name="selected_students"]');
                const enrollButton = document.getElementById('enroll-button');

                checkboxes.forEach((checkbox) => {
                  checkbox.addEventListener('change', () => {
                    const anyCheckboxChecked = [...checkboxes].some((checkbox) => checkbox.checked);
                    enrollButton.disabled = !anyCheckboxChecked;
                  });
                });

                enrollButton.addEventListener('click', () => {
                  const selectedCourses = [...checkboxes]
                    .filter((checkbox) => checkbox.checked)
                    .map((checkbox) => checkbox.value);

                  // Redirect to the edit view with the selected course(s) IDs
                  const editURL = `/student/course/${selectedCourses.join(',')}/enroll/`;
                  window.location.href = editURL;
                });
              </script>

            <br>
            <br>
            <nav aria-label="Page navigation">
              <ul class="pagination">
                {% if page_obj.has_previous %}
                  <li class="page-item">
                    <a class="page-link" href="?page={{ page_obj.previous_page_number }}">Previous</a>
                  </li>
                {% endif %}
                {% for i in page_obj.paginator.page_range %}
                  <li class="page-item {% if page_obj.number == i %}active{% endif %}">
                    <a class="page-link" href="?page={{ i }}">{{ i }}</a>
                  </li>
                {% endfor %}
                {% if page_obj.has_next %}
                  <li class="page-item">
                    <a class="page-link" href="?page={{ page_obj.next_page_number }}">Next</a>
                  </li>
                {% endif %}
              </ul>
            </nav>

      </div>
    </div>
{% endblock %}